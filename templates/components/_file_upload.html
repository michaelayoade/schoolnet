{% macro file_upload_zone(name, label, hint="", accept="image/*", current_url="", remove_name="remove_file") %}
<div class="rounded-xl border border-slate-200 p-4 dark:border-slate-700"
     x-data="{ preview: '{{ current_url }}', filename: '' }">
  <label class="block text-sm font-semibold text-slate-700 dark:text-slate-200">{{ label }}</label>
  {% if hint %}
  <p class="mt-1 text-xs text-slate-500 dark:text-slate-400">{{ hint }}</p>
  {% endif %}

  <div class="mt-3 flex items-start gap-4">
    <div class="h-16 w-16 overflow-hidden rounded-lg border border-slate-200 bg-slate-50 dark:border-slate-700 dark:bg-slate-800">
      <template x-if="preview">
        <img :src="preview" alt="Preview" class="h-full w-full object-cover">
      </template>
      <template x-if="!preview">
        <div class="flex h-full w-full items-center justify-center text-[10px] text-slate-400">No file</div>
      </template>
    </div>

    <div class="flex-1 space-y-2">
      <input type="file"
             name="{{ name }}"
             accept="{{ accept }}"
             class="block w-full text-sm text-slate-600 file:mr-3 file:rounded-md file:border-0 file:bg-primary-600 file:px-3 file:py-1.5 file:text-xs file:font-semibold file:text-white hover:file:bg-primary-700"
             @change="
               const f = $event.target.files[0];
               filename = f ? f.name : '';
               if (f) {
                 const reader = new FileReader();
                 reader.onload = e => { preview = e.target.result; };
                 reader.readAsDataURL(f);
               }
             ">
      <p class="text-xs text-slate-500 dark:text-slate-400" x-text="filename"></p>
      <label class="inline-flex items-center gap-2 text-xs text-slate-500 dark:text-slate-400">
        <input type="checkbox" name="{{ remove_name }}" value="1" @change="if ($event.target.checked) { preview = ''; filename=''; }">
        Remove current file
      </label>
    </div>
  </div>
</div>
{% endmacro %}
